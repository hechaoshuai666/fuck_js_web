# 土巴兔密码参数分析

项目地址: **aHR0cHM6Ly93d3cudG84dG8uY29tL25ld19sb2dpbi5waHA=**

## 第一步(观察加密参数)

老规矩,账号随意,密码123456,查看加密后的特征

![image-20201027204629976](C:\Users\WilliamWeson\AppData\Roaming\Typora\typora-user-images\image-20201027204629976.png)

显然password是被url编码过的,解码后发现

![image-20201027204700436](C:\Users\WilliamWeson\AppData\Roaming\Typora\typora-user-images\image-20201027204700436.png)

是一串这样的玩意,经过初步分析,可能是aes,des,rsa,具体是什么我们也不清楚,先找到加密位置康康吧

## 第二步(查找加密位置)

![image-20201027205125149](C:\Users\WilliamWeson\AppData\Roaming\Typora\typora-user-images\image-20201027205125149.png)

这里有个很明显的地方,就是它不是通过ajax发送的包,很大可能是点击按钮事件或者form发送,我们直接去找它的事件

![image-20201027205420810](C:\Users\WilliamWeson\AppData\Roaming\Typora\typora-user-images\image-20201027205420810.png)

通过事件处的查找,很快发现了这个函数,那我们全局搜索这个函数

![image-20201027205510111](C:\Users\WilliamWeson\AppData\Roaming\Typora\typora-user-images\image-20201027205510111.png)

立马就找到对应的加密位置,下个断点,康康什么加密

![image-20201027205608112](C:\Users\WilliamWeson\AppData\Roaming\Typora\typora-user-images\image-20201027205608112.png)

很明显是rsa加密,非对称加密算法,我们只要找到指数和模数,或者公钥,就可以成功加密数据了

![image-20201027205707845](C:\Users\WilliamWeson\AppData\Roaming\Typora\typora-user-images\image-20201027205707845.png)

进到函数的定义处,管它三七二十一,直接全copy走

## 第三步(扣代码)

拿到v8引擎里调用,缺啥补啥,最后通过window.RSAUtilszb.encryptfun就可以拿到我们想要的值了

结束,peace